(this.webpackJsonpkuasv1=this.webpackJsonpkuasv1||[]).push([[21],{319:function(e,t,n){},457:function(e,t,n){"use strict";n.r(t);n(32);var a=n(0),r=n(21),s=n(19),c=n(13),o=n.n(c),i=(n(319),n(12)),l=n(9),u=n.n(l),d=n(102),j=(n(324),n(467)),f=n(451),h=n(410),b=n(301),p=n(474),g=n(482),O=n(439),m=n(475),x=n(72),_=n(22),v=n(1);var k=function(){var e,t,n=d.a.storage(),c=Object(a.useState)(!1),l=Object(s.a)(c,2),k=l[0],y=l[1],P=Object(a.useState)(0),S=Object(s.a)(P,2),N=S[0],w=S[1],T=Object(a.useState)(!1),C=Object(s.a)(T,2),I=C[0],F=C[1],A=Object(a.useState)({}),E=Object(s.a)(A,2),W=E[0],q=E[1],z=Object(a.useState)(""),B=Object(s.a)(z,2),G=(B[0],B[1],Object(a.useState)(null)),J=Object(s.a)(G,2),U=J[0],L=J[1],D=Object(i.b)(),M=Object(s.a)(D,2),Y=M[0],K=(M[1],Object(a.useState)((null===(e=Y.user)||void 0===e?void 0:e.uid)||u.a.get("uid")||null)),R=Object(s.a)(K,2),H=R[0],Q=(R[1],Object(a.useState)((null===(t=Y.user)||void 0===t?void 0:t.id)||u.a.get("id")||null)),V=Object(s.a)(Q,2),X=(V[0],V[1],Object(a.useState)(null)),Z=Object(s.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(null),ne=Object(s.a)(te,2),ae=ne[0],re=ne[1],se=Object(a.useState)(null),ce=Object(s.a)(se,2),oe=ce[0],ie=ce[1],le=Object(a.useState)(null),ue=Object(s.a)(le,2),de=ue[0],je=ue[1],fe=function(e){n.ref("images/".concat(e.name)).put(e).on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);w(t)}),(function(e){console.log(e),alert("opps someting went wrong when uploading image"),F(!1)}),(function(){n.ref("images").child(e.name).getDownloadURL().then((function(e){fetch("http://localhost:8080/users/addProfilePicture",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({image_url:e,image_id:W.id})}).then((function(e){if(e.ok)return e.json();throw e})).then((function(t){L(e),w(0),F(!1)})).catch((function(e){F(!1),alert("Sorry, Some server error happended while adding the  profile picture!"),"function"===typeof e.json&&e.json().then((function(e){})).catch((function(e){}))}))}))}))},he=function(){y(!1)},be=function(){var e=u.a.get("accessToken");return e||alert(" we couldnt get your stored sessionin  data . Please try logging in again"),fetch("http://localhost:8080/users/updateProfile",{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({address:de,uid:H,first_name:ae,last_name:oe})}).then((function(e){if(403==e.status)return"Token expired error";if(e.ok)return e.json();throw e}))},pe=function(){var e=Object(r.a)(o.a.mark((function e(){var t,n,a,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(r.length>0&&void 0!==r[0])||r[0],F(!0),e.prev=2,e.next=5,be();case 5:if("Token expired error"!=(n=e.sent)||!t){e.next=18;break}return e.next=9,Object(_.g)();case 9:if(a=e.sent){e.next=13;break}return console.log("We couldnt get new tokens and refresh token for you. Sorry"),e.abrupt("return");case 13:u.a.set("accessToken",a.accessToken),u.a.set("refreshToken",a.refreshToken),pe(!1),e.next=19;break;case 18:"Token expired error"!==n&&(ee(n),F(!1));case 19:e.next=26;break;case 21:e.prev=21,e.t0=e.catch(2),F(!1),alert("Sorry, Some server error happended while updating profile details!"),"function"===typeof e.t0.json?e.t0.json().then((function(e){})).catch((function(e){})):console.log(e.t0);case 26:y(!1);case 27:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=u.a.get("accessToken");return e||alert(" we couldnt get your stored sessionin  data . Please try logging in again "),fetch("http://localhost:8080/users/getProfile/"+H,{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+e}}).then((function(e){if(403==e.status)return"Token expired error";if(e.ok)return e.json();throw e}))},Oe=function(e){var t=u.a.get("accessToken");return t||alert(" we could get your stored sessionin  data . Please try logging in again "),fetch("http://localhost:8080/users/getProfilePicture/"+e,{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(e.ok)return e.json();throw e}))},me=function(){var e=Object(r.a)(o.a.mark((function e(){var t,n,a,r,s,c=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(c.length>0&&void 0!==c[0])||c[0],console.log(t),e.prev=2,e.next=5,ge();case 5:if("Token expired error"!=(n=e.sent)||!t){e.next=19;break}return e.next=9,Object(_.g)();case 9:if(a=e.sent,console.log("here are te tokens",a),a){e.next=14;break}return console.log("We couldnt get new tokens and refresh token for you. Sorry"),e.abrupt("return");case 14:u.a.set("accessToken",a.accessToken),u.a.set("refreshToken",a.refreshToken),me(!1),e.next=30;break;case 19:if(!(n.length>0&&n[0].id)){e.next=30;break}return r={id:n[0].id,firstName:n[0].first_name,lastName:n[0].last_name,phoneNumber:n[0].phone_number,email:n[0].email,location:n[0].address},F(!1),q(r),re(r.firstName),ie(r.lastName),je(r.location),e.next=28,Oe(n[0].id);case 28:(s=e.sent).length>0&&L(s[0].image_url);case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(2),F(!1),"function"===typeof e.t0.json&&e.t0.json().then((function(e){})).catch((function(e){}));case 36:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)(me,[$]),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"profilePage__content",children:[Object(v.jsxs)("div",{className:"profilePage__imageSection",children:[Object(v.jsxs)("div",{className:"profilePage__imageSection__image",children:[Object(v.jsx)("img",{src:U||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuqf58ptYjurFfvxzCIylYa9tD6s_011kbKw&usqp=CAU",alt:""}),Object(v.jsx)("input",{type:"file",name:"Upload Image",accept:"image/*",id:"imageInput",onChange:function(e){e.target.files[0]&&fe(e.target.files[0])}}),Object(v.jsx)("label",{htmlFor:"imageInput",children:" Change Profile Picture"}),N<=100&&N>0?Object(v.jsx)("div",{className:"profilePage__imageSection__image__loader",children:Object(v.jsx)(j.a,{className:"profilePage__imageSection__image__loader__icon",variant:"determinate",value:N})}):""]}),Object(v.jsx)(f.a,{onClick:function(){y(!0)},children:" Edit Profile "}),Object(v.jsxs)(h.a,{open:k,onClose:he,children:[Object(v.jsx)(b.a,{children:"Edit Profile"}),Object(v.jsxs)(p.a,{children:[Object(v.jsx)(g.a,{}),Object(v.jsx)(O.a,{required:!0,autoFocus:!0,margin:"dense",id:"firstname",label:"First Name",value:ae,onChange:function(e){return re(e.target.value)},fullWidth:!0,variant:"standard"}),Object(v.jsx)(O.a,{autoFocus:!0,margin:"dense",id:"lastname",label:"Last Name",value:oe,onChange:function(e){return ie(e.target.value)},fullWidth:!0,variant:"standard"}),Object(v.jsx)(O.a,{autoFocus:!0,margin:"dense",id:"address",label:"Address",value:de,onChange:function(e){return je(e.target.value)},fullWidth:!0,variant:"standard"})]}),Object(v.jsxs)(m.a,{children:[Object(v.jsx)(f.a,{onClick:he,children:"Cancel"}),Object(v.jsx)(f.a,{onClick:pe,children:"Save"})]})]})]}),Object(v.jsxs)("div",{className:"profilePage__content__info",children:[Object(v.jsxs)("p",{children:[" ",Object(v.jsx)("b",{children:"Contact Information "})," "]}),Object(v.jsxs)("div",{className:"profilePage__content__pairsOfInfo",children:[Object(v.jsx)("p",{children:" Full Name: "}),Object(v.jsxs)("p",{style:{color:"blue"},children:[" ",W.firstName," ",W.lastName," "]})]}),Object(v.jsxs)("div",{className:"profilePage__content__pairsOfInfo",children:[Object(v.jsx)("p",{children:" Phone Number: "}),Object(v.jsxs)("p",{style:{color:"blue"},children:[" ",W.phoneNumber," "]})]}),Object(v.jsxs)("div",{className:"profilePage__content__pairsOfInfo",children:[Object(v.jsx)("p",{children:" EMail: "}),Object(v.jsxs)("p",{style:{color:"blue"},children:[" ",W.email," "]})]}),Object(v.jsxs)("p",{children:[" ",Object(v.jsx)("b",{children:"General Information "})," "]}),Object(v.jsxs)("div",{className:"profilePage__content__pairsOfInfo",children:[Object(v.jsx)("p",{children:" Location: "}),Object(v.jsxs)("p",{style:{color:"blue"},children:[" ",W.location," "]})]})]})]}),I?Object(v.jsx)(x.a,{}):""]})},y=n(68),P=n(69);t.default=function(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(P.a,{}),Object(v.jsx)(k,{firstname:e.firstname,lastname:u.a.get("lastname")}),Object(v.jsx)(y.a,{})]})}}}]);
//# sourceMappingURL=21.b34e4de7.chunk.js.map